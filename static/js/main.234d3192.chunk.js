(this["webpackJsonpreact-chess"]=this["webpackJsonpreact-chess"]||[]).push([[0],{30:function(e,t,n){},38:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var o=n(1),c=n.n(o),i=n(20),s=n.n(i),a=(n(30),n(25)),r=n(2),d=n(24),l=n(4),u=n(34),f=function(){var e=Object(o.useState)(new u("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")),t=Object(r.a)(e,1)[0],n=Object(o.useState)(t.fen()),c=Object(r.a)(n,2),i=c[0],s=c[1],a=Object(o.useState)(),d=Object(r.a)(a,2),f=d[0],b=d[1],h=Object(o.useState)(!1),v=Object(r.a)(h,2),j=v[0],p=v[1],m=Object(o.useState)(),g=Object(r.a)(m,2),O=g[0],w=g[1],x=Object(o.useState)(),k=Object(r.a)(x,2),M=k[0],P=k[1],C=Object(o.useState)(!1),S=Object(r.a)(C,2),y=S[0],E=S[1];Object(o.useEffect)((function(){console.log("pendingMove: ",f)}),[f]);var N=function(){return p(!0)},_=function(e){for(var n=t.moves({verbose:!0}),o=0,c=n.length;o<c;o++)if(-1!==n[o].flags.indexOf("p")&&n[o].from===e.from)return b([e.from,e.to]),void N();var i=t.move(e);i&&(console.log(i.san),s(t.fen()),console.log("GAME STATS",{in_check:t.in_check(),in_checkmate:t.in_checkmate(),in_stalemate:t.in_stalemate(),in_threefold_repetition:t.in_threefold_repetition()}),E(t.game_over()),w([e.from,e.to]),P(t.history()))};return{chess:t,turnColor:function(){return"w"===t.turn()?l.a[0]:l.a[1]},handleMove:_,undoMove:function(){var e=t.undo();w([null===e||void 0===e?void 0:e.from,null===e||void 0===e?void 0:e.to]),s(t.fen())},pendingMove:f,lastMove:O,fen:i,promotion:function(e){var n=f[0],o=f[1];t.move({from:n,to:o,promotion:e}),s(t.fen()),p(!1)},calcMovable:function(){var e=new Map;return t.SQUARES.forEach((function(n){var o=t.moves({square:n,verbose:!0});o.length&&e.set(n,o.map((function(e){return e.to})))})),{free:!1,dests:e,showDests:!0,events:{after:function(e,t,n){return _({from:e,to:t})}},rookCastle:!0}},promotionModal:j,showPromotionModal:N,movesLog:M,gameOver:y}},b=n.p+"static/media/wQ.b069e38b.svg",h=n.p+"static/media/wR.a5a16b36.svg",v=n.p+"static/media/wB.6a5db4e0.svg",j=n.p+"static/media/wN.72ce2510.svg",p=(n(38),n(10)),m=n.n(p),g=n(21),O=n(22),w=n.n(O),x=n(23),k=n.n(x),M=function(){var e=Object(o.useState)(null),t=Object(r.a)(e,2),n=t[0],c=t[1],i=w.a.createInstance("f4b36b6c897e41bfaa3904d75da40777"),s={uid:(Math.floor(9e4*Math.random())+1e4).toString(),token:""};Object(o.useEffect)((function(){(function(){var e=Object(g.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.a.get("https://agoratokenserver-demo.herokuapp.com/access_token?channel=test&uid=".concat(s.uid)).then((function(e){var t;console.log(e),s.token=(null===(t=e.data)||void 0===t?void 0:t.token)||"",i.login(s).then((function(){console.log("Login successful");var e=i.createChannel("test");e.join(),c(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){console.log("integrations successful")}))}),[]),Object(o.useEffect)((function(){n&&(null===n||void 0===n||n.on("ChannelMessage",(function(e,t){var n=JSON.parse(e.text);window.document.getElementById("chat-section").appendChild(document.createElement("div")).append("".concat(n.uid,": ").concat(n.msg))})),null===n||void 0===n||n.on("MemberJoined",(function(e){console.log("New member joined: ",e)})))}),[n]);return{playerMeta:s,sendMsgInChannel:function(e){var t={uid:s.uid,msg:e},o={text:JSON.stringify(t)||"",messageType:"TEXT"};null===n||void 0===n||n.sendMessage(o).then((function(){window.document.getElementById("chat-section").appendChild(document.createElement("div")).append("".concat(s.uid,": ").concat(t.msg))}))}}},P=n(0);var C=function(){var e=f(),t=e.chess,n=e.turnColor,c=e.undoMove,i=e.lastMove,s=e.fen,l=e.promotion,u=e.calcMovable,p=e.promotionModal,m=e.movesLog,g=M().sendMsgInChannel,O=Object(o.useState)(window.innerWidth),w=Object(r.a)(O,2),x=w[0],k=w[1],C=Object(o.useState)(window.innerHeight),S=Object(r.a)(C,2),y=S[0],E=S[1];Object(o.useEffect)((function(){return N(),window.addEventListener("resize",N),function(){return window.removeEventListener("resize",N)}}),[]);var N=function(){k(window.innerWidth),E(window.innerHeight)},_={fen:s,coordinates:!0,turnColor:n(),addPieceZIndex:!0,autoCastle:!0,lastMove:i,highlight:{lastMove:!0,check:!0},selectable:{enabled:!0},movable:u(),events:{select:function(e){}}};return Object(P.jsxs)("div",{className:"app",id:"chessboard",children:[Object(P.jsxs)("div",{className:"side-section",children:[Object(P.jsx)("div",{children:null===m||void 0===m?void 0:m.map((function(e){return Object(P.jsxs)(P.Fragment,{children:[e,", "]})}))}),p&&Object(P.jsxs)("div",{className:"piece-promotion-prompt",children:["Promote To?",Object(P.jsxs)("div",{className:"roles",children:[Object(P.jsx)("span",{role:"presentation",onClick:function(){return l("q")},children:Object(P.jsx)("img",{src:b,alt:"",style:{width:50}})}),Object(P.jsx)("span",{role:"presentation",onClick:function(){return l("r")},children:Object(P.jsx)("img",{src:h,alt:"",style:{width:50}})}),Object(P.jsx)("span",{role:"presentation",onClick:function(){return l("b")},children:Object(P.jsx)("img",{src:v,alt:"",style:{width:50}})}),Object(P.jsx)("span",{role:"presentation",onClick:function(){return l("n")},children:Object(P.jsx)("img",{src:j,alt:"",style:{width:50}})})]})]}),"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"!==t.fen()&&Object(P.jsx)("div",{className:"undo-btn",onClick:function(){c()},children:"Undo"}),Object(P.jsxs)("div",{children:[Object(P.jsx)("div",{id:"chat-section",className:"chat-section",style:{padding:10,border:"black"}}),Object(P.jsxs)("div",{style:{display:"flex"},children:[Object(P.jsx)("input",{type:"text",id:"chatbox"}),Object(P.jsx)("button",{onClick:function(){g(window.document.getElementById("chatbox").value)},style:{padding:10},children:"Send"})]})]})]}),Object(P.jsx)("div",{className:"main-chessboard",children:Object(P.jsx)(d.a,{width:x<y?.5*x:.5*y,height:x<y?.5*x:.5*y,config:Object(a.a)({},_)})})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,61)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),o(e),c(e),i(e),s(e)}))};s.a.render(Object(P.jsx)(c.a.StrictMode,{children:Object(P.jsx)(C,{})}),document.getElementById("root")),S()}},[[60,1,2]]]);
//# sourceMappingURL=main.234d3192.chunk.js.map